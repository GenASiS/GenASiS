# Makefile Summit with GCC compiler

FORTRAN_COMPILE      = mpif90 -c -cpp
FORTRAN_BOUND_CHECK  = -fbounds-check
FORTRAN_DEBUG        = -g -ffpe-trap=invalid,zero,overflow #-Wall
FORTRAN_OPTIMIZE     = -Ofast
FORTRAN_PROFILE      = -O2 -g

CC_COMPILE           = mpicc -c
CC_DEBUG             = -g
CC_OPTIMIZE          = $(FORTRAN_OPTIMIZE)

LINK = mpif90

#-- Silo library include and link line flag and location
SILO_DIR=/sw/peak/caascade/silo/4.10.2/gcc8.1.0
INCLUDE_SILO = -I${SILO_DIR}/include
LIBRARY_SILO = -L${SILO_DIR}/lib -lsilo

#-- HDF5 library include and link line flag and location
INCLUDE_HDF5 = -I${OLCF_HDF5_ROOT}/include
LIBRARY_HDF5 = -L${OLCF_HDF5_ROOT}/lib -lhdf5_fortran -lhdf5

#-- LAPACK library link line flag and location
LIBRARY_LAPACK = #-L${OLCF_NETLIB_LAPACK_ROOT}/lib -llapack -lblas

ifeq ($(ENABLE_OMP_OFFLOAD), 1)
INCLUDE_CUDA = -I${OLCF_CUDA_ROOT}/include
LIBRARY_CUDA = -L${OLCF_CUDA_ROOT}/lib64 -lcudart
endif

INCLUDE_PREPROCESSOR = -I$(PATH_GENASIS)/Build

#-- Enable unicode
USE_ISO_10646 = 

#-- Enable OpenMP by default
ifneq ($(ENABLE_OMP), 0)
  DEFINES = -fopenmp -foffload=disable
endif

#-- Enable offload if requested
ifeq ($(ENABLE_OMP_OFFLOAD), 1)
  DEFINES = -fopenmp -foffload=nvptx-none="-lm -lgfortran" -DENABLE_OMP_OFFLOAD
endif
