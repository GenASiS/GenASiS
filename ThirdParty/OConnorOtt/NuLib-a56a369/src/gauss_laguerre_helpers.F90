!-*-f90-*-
subroutine GaussLaguerreQuadrature_roots_and_weights(n,roots,weights)

  implicit none
  
  !inputs
  integer, intent(in) :: n !degree of GaussLaguerreQuadrature
  
  !outputs
  real*8, dimension(:), intent(out) :: roots(n) !roots of polynomial, user must be sure the size of array comforms
  real*8, dimension(:), intent(out) :: weights(n) !weights for integration, note we add in the Exp[x] in the weights because our functions do not have an explicit Exp[-x]

  select case (n)
  case (4)
     roots = (/0.32254768961939231180d0, 1.7457611011583465757d0, 4.5366202969211279833d0, &
          9.3950709123011331292d0/)
     weights = (/0.8327391238378892466d0, 2.048102438454296821d0, 3.631146305821517862d0, &
          6.48714508440766227d0/)
  case (16)
     roots = (/0.087649410478927840360d0, 0.46269632891508083188d0, &
          1.1410577748312268569d0, 2.1292836450983806163d0, 3.4370866338932066452d0, &
          5.0780186145497679129d0, 7.0703385350482341304d0, 9.4383143363919387839d0, &
          12.214223368866158737d0, 15.441527368781617077d0, 19.180156856753134855d0, &
          23.515905693991908532d0, 28.578729742882140368d0, 34.583398702286625815d0, &
          41.940452647688332635d0, 51.701160339543318364d0/)
     weights = (/0.2250363148642472519d0, 0.525836052762342454d0, &
          0.831961391687087088d0, 1.146099240963751705d0, 1.471751316966808589d0, &
          1.813134687381348165d0, 2.175517519694607452d0, 2.56576275016502921d0, &
          2.99321508637137517d0,  3.47123448310209029d0, 4.02004408644466887d0, &
          4.67251660773285427d0, 5.48742065798615247d0, 6.58536123328921366d0, &
          8.27635798436423449d0, 11.8242775516584348d0/)
  case (32)
     roots = (/0.044489365833267018419d0, 0.23452610951961853745d0, &
          0.57688462930188642649d0, 1.0724487538178176330d0, 1.7224087764446454411d0, &
          2.5283367064257948811d0, 3.4922132730219944896d0, 4.6164567697497673878d0, &
          5.9039585041742439466d0, 7.3581267331862411132d0, 8.9829409242125961034d0, &
          10.783018632539972068d0, 12.763697986742725115d0, 14.931139755522557320d0, &
          17.292454336715314789d0, 19.855860940336054740d0, 22.630889013196774489d0, &
          25.628636022459247767d0, 28.862101816323474744d0, 32.346629153964737003d0, &
          36.100494805751973804d0, 40.145719771539441536d0, 44.509207995754937976d0, &
          49.224394987308639177d0, 54.333721333396907333d0, 59.892509162134018196d0, &
          65.975377287935052797d0, 72.687628090662708639d0, 80.187446977913523067d0, & 
          88.735340417892398689d0, 98.829542868283972559d0, 111.75139809793769521d0/)
     weights = (/0.1141871057681048489d0, 0.266065216897615216d0, 0.418793137324852994d0, &
          0.572532846499804706d0, 0.727648788380971311d0, 0.884536719340249717d0, &
          1.043618875892076967d0, 1.205349274152352580d0, 1.37022133852178119d0, &
          1.53877725646864475d0, 1.71161935268645726d0, 1.88942406344948410d0, &
          2.07295934024653367d0, 2.26310663399696361d0, 2.46088907248823613d0, &
          2.66750812639711715d0, 2.88439209292204179d0, 3.11326132703958618d0, &
          3.35621769259580256d0, 3.61586985648426881d0, 3.89551304494854956d0, &
          4.19939410471158549d0, 4.53311497853436177d0, 4.90427028761124484d0, &
          5.32350097202366611d0, 5.80633321423362136d0, 6.37661467415965254d0, &
          7.0735265807072421d0, 7.9676935092959007d0, 9.2050403312781896d0, &
          11.1630130907678731d0, 15.3901804152606431d0/)
  case (64)
     roots = (/0.022415874146705280023d0, 0.11812251209677047980d0, &
          0.29036574401803648400d0, 0.53928622122797903932d0, &
          0.86503700464811394462d0, 1.2678140407752413981d0, 1.7478596260594362528d0, &
          2.3054637393075087185d0, 2.9409651567252518407d0, 3.6547526502072905270d0, &
          4.4472663433130943567d0, 5.3189992544963903435d0, 6.2704990469236539129d0, &
          7.3023700025873957472d0, 8.4152752394830241945d0, 9.6099391927961080358d0, &
          10.887150383886372143d0, 12.247764504244301618d0, 13.692707845547505153d0, &
          15.222981111524728848d0, 16.839663652648737211d0, 18.543918170859190524d0, &
          20.336995948730235501d0, 22.220242665950876540d0, 24.195104875933253990d0, &
          26.263137227118485785d0, 28.426010527501027299d0, 30.685520767525971771d0, &
          33.043599236437829126d0, 35.502323891141209587d0, 38.063932165646468260d0, &
          40.730835444458626366d0, 43.505635466421529853d0, 46.391142978616192074d0, &
          49.390399025624686679d0, 52.506699341346301650d0, 55.743622413278380463d0, &
          59.105061919017106609d0, 62.595264400151395596d0, 66.218873251247564382d0, &
          69.980980377146829229d0, 73.887187232482963211d0, 77.943677434463120314d0, &
          82.157303778319304295d0, 86.535693349456518210d0, 91.087375613133090146d0, &
          95.821940015520732095d0, 100.75023196951397963d0, 105.88459946879994936d0, &
          111.23920752443958206d0, 116.83044505130649846d0, 122.67746026853857658d0, &
          128.80287876923767251d0, 135.23378794952582783d0, 142.00312148993151903d0, &
          149.15166590004938859d0, 156.73107513267116123d0, 164.80860265515052299d0, &
          173.47494683642427452d0, 182.85820469143146365d0, 193.15113603707291148d0, &
          204.67202848505945595d0, 218.03185193532851633d0, 234.80957917132616471d0/)
     weights = (/0.0575280378894525890d0, 0.133947450012544835d0, 0.210559520190062753d0, &
          0.287306741593137459d0, 0.364227443636669253d0, 0.441366991509961980d0, &
          0.518772490744390801d0, 0.596492178616888933d0, 0.674575428995967007d0, &
          0.75307288621771403d0, 0.83203664061384097d0, 0.91152042608958027d0, &
          0.99157983552704779d0, 1.07227255416963941d0, 1.15365861273396412d0, &
          1.23580066279341249d0, 1.31876427755265408d0, 1.40261828167573411d0, &
          1.48743511441922552d0, 1.57329123099770495d0, 1.66026754790322604d0, &
          1.74844993884468967d0, 1.83792978910258782d0, 1.92880461745247174d0, &
          2.02117877644994616d0, 2.11516424385799163d0, 2.21088152041886538d0, &
          2.30846065213609280d0, 2.40804239887634595d0, 2.50977957560631372d0, &
          2.61383859818030413d0, 2.72040127259742280d0, 2.82966687545834170d0, &
          2.94185458451072051d0, 3.05720633240365252d0, 3.17599017505567106d0, &
          3.29850428971767201d0, 3.42508174873032369d0, 3.55609625571314495d0, &
          3.69196908511496649d0, 3.83317753889189122d0, 3.98026533306148233d0, &
          4.13385546300965414d0, 4.29466628606838520d0, 4.4635318277968967d0, &
          4.6414277027025426d0, 4.8295046006493150d0, 5.0291321227984098d0, &
          5.2419570128773013d0, 5.4699817855490906d0, 5.7156728619183667d0, &
          5.9821124019170983d0, 6.2732165922168386d0, 6.5940581356188163d0, &
          6.9513580176959900d0, 7.3542639486080784d0, 7.8156389859664634d0, &
          8.3543144845334196d0, 8.9993075322557026d0, 9.7984432991094467d0, &
          10.8382034590564481d0, 12.2978755043572692d0, 14.6428784968432459d0, &
          19.7904730417376936d0/)
  case(128)
     roots = (/0.011251388263675962328d0, 0.059284741269026455801d0, &
          0.14570796659431245468d0, 0.27055317875866508048d0, &
          0.43384140755383682198d0, 0.63559766578162191220d0, &
          0.87585238454652081241d0, 1.1546417019743979715d0, 1.4720075631667355331d0, &
          1.8279977783123502189d0, 2.2226660715619024344d0, 2.6560721298834812920d0, &
          3.1282816550279171075d0, 3.6393664198524033893d0, 4.1894043295940477378d0, &
          4.7784794884348764654d0, 5.4066822716004994120d0, 6.0741094031965365829d0, &
          6.7808640399756257011d0, 7.5270558612293756440d0, 8.3128011650077713313d0, &
          9.1382229708803919266d0, 10.003451129468222902d0, 10.908622438990882131d0, &
          11.853880769091857061d0, 12.839377192223249580d0, 13.865270122892081162d0, &
          14.931725465091927774d0, 16.038916768267078794d0, 17.187025392181265460d0, &
          18.376240681089694107d0, 19.606760147641647762d0, 20.878789666971371730d0, &
          22.192543681467835626d0, 23.548245416748919467d0, 24.946127109403487765d0, &
          26.386430247105291613d0, 27.869405821746390473d0, 29.395314596284912056d0, &
          30.964427386052754798d0, 32.577025355323748101d0, 34.233400330002240253d0, &
          35.933855127356153503d0, 37.678703903788374419d0, 39.468272521715761059d0, &
          41.302898936707087785d0, 43.182933606120386116d0, 45.108739920577228588d0, &
          47.080694659717217121d0, 49.099188473791024023d0, 51.164626392776661135d0, &
          53.277428364840773156d0, 55.438029826117890764d0, 57.646882303945226056d0, &
          59.904454055872058404d0, 62.211230746961454940d0, 64.567716168121208398d0, &
          66.974432998441557174d0, 69.431923614783428889d0, 71.940750952154374431d0, &
          74.501499418734027813d0, 77.114775869770568306d0, 79.781210644968552970d0, &
          82.501458674431447093d0, 85.276200658715353597d0, 88.106144329099507218d0, &
          90.992025794792610327d0, 93.934610984479689932d0, 96.934697190381939436d0, &
          99.993114723864266580d0, 103.11072869259398033d0, 106.28844091034544306d0, &
          109.52719195177755296d0, 112.82796336590419628d0, 116.19178006355677724d0, &
          119.61971289593201107d0, 123.11288144336019457d0, 126.67245703576018911d0, &
          130.29966602891346383d0, 133.99579336374796412d0, 137.76218643933938779d0, &
          141.60025933439303003d0, 145.51149741665958004d0, 149.49746238517769825d0, &
          153.55979779656644268d0, 157.70023513397811143d0, 161.92060048597562627d0, &
          166.22282191276886465d0, 170.60893758924223107d0, 175.08110482841459543d0, &
          179.64161010586698808d0, 184.29288022584680107d0, 189.03749479395409594d0, &
          193.87820019047296682d0, 198.81792527372058998d0, 203.85979908576985054d0, &
          209.00717088551087386d0, 214.26363289878801766d0, 219.63304625557816507d0, &
          225.11957068420903738d0, 230.72769865820362156d0, 236.46229485017767047d0, &
          242.32864194970269978d0, 248.33249416235719309d0, 254.48014004486913109d0, &
          260.77847677357971179d0, 267.23509852895381300d0, 273.85840246269361842d0, &
          280.65771677632346837d0, 287.64345689921935900d0, 294.82731778764775754d0, &
          302.22251324644946635d0, 309.84407732661264845d0, 317.70924895490628614d0, &
          325.83797012119492820d0, 334.25354206765410936d0, 342.98350627382529865d0, &
          352.06085354652617525d0, 361.52572639232505480d0, 371.42788921432753568d0, &
          381.83044411906109872d0, 392.81567124080811482d0, 404.49472475051504716d0, &
          417.02490297798902930d0, 430.64344416659736225d0, 445.74309697392800445d0, &
          463.08003410944627376d0, 484.61554398644398134d0/)
     weights = (/0.028874906380287286886d0, 0.067219473590123528840d0, &
          0.10563085860987169662d0, 0.14406297271808829592d0, &
          0.18251763897072244583d0, 0.22099994569924238167d0, &
          0.25951551341154841590d0, 0.29807011138271633899d0, &
          0.33666957856954803131d0, 0.37531980493875799596d0, &
          0.41402672852487103680d0, 0.45279633747263777205d0, &
          0.49163467393862579143d0, 0.53054783880765771133d0, &
          0.56954199683813618275d0, 0.60862338208429899289d0, &
          0.64779830353554182456d0, 0.68707315095092151428d0, &
          0.72645440088604332375d0, 0.76594862291764314470d0, &
          0.80556248607578452699d0, 0.84530276549778620243d0, &
          0.88517634931805288429d0, 0.92519024581214524017d0, &
          0.96535159081182317724d0, 1.0056676554124278530d0, 1.0461458539922988828d0, &
          1.0867937525678921973d0, 1.1276190775078530015d0, 1.1686297246324364399d0, &
          1.2098337687256285191d0, 1.2512394734890693414d0, 1.2928553019703154089d0, &
          1.3346899274980307187d0, 1.3767522451619561277d0, 1.4190513838755936271d0, &
          1.4615967190643348093d0, 1.5043978860243154578d0, 1.5474647940006396564d0, &
          1.5908076410380804527d0, 1.6344369296614619040d0, 1.6783634834465800936d0, &
          1.7225984645498419817d0, 1.7671533922680640149d0, 1.8120401627074324022d0, &
          1.8572710696471335808d0, 1.9028588266908415654d0, 1.9488165908069082323d0, &
          1.9951579873672662578d0, 2.0418971368070436127d0, 2.0890486830341049332d0, &
          2.1366278237348032270d0, 2.1846503427314812696d0, 2.2331326445662457530d0, &
          2.2820917914994887294d0, 2.3315455431326991782d0, 2.3815123988838669862d0, &
          2.4320116435699725834d0, 2.4830633963746692451d0, 2.5346886635098803013d0, &
          2.5869093949130324190d0, 2.6397485453583226424d0, 2.6932301404018522103d0, &
          2.7473793476281223175d0, 2.8022225537171161139d0, 2.8577874479129462044d0, &
          2.9141031125412397304d0, 2.9712001213001372974d0, 3.0291106461389200733d0, &
          3.0878685736361955418d0, 3.1475096319053207755d0, 3.2080715291859418977d0, &
          3.2695941054301337555d0, 3.3321194983646845905d0, 3.3956923257114494118d0, &
          3.4603598854771281914d0, 3.5261723764923464866d0, 3.5931831416893516421d0, &
          3.6614489369710021071d0, 3.7310302289462220545d0, 3.8019915253037537785d0, &
          3.8744017421795128161d0, 3.9483346135609509875d0, 4.0238691485888571197d0, &
          4.1010901435830380634d0, 4.1800887567755487316d0, 4.2609631551163996500d0, &
          4.3438192441788944014d0, 4.4287714941973177176d0, 4.5159438776998952694d0, &
          4.6054709371610163691d0, 4.6974990047195610738d0, 4.7921876004646197091d0, &
          4.8897110412995752826d0, 4.9902602992453717745d0, 5.0940451566104145153d0, &
          5.2012967162398377234d0, 5.3122703387167910565d0, 5.4272490958213641344d0, &
          5.5465478519564524031d0, 5.6705181142770380416d0, 5.7995538301816293424d0, &
          5.9340983608168832405d0, 6.0746529257828298326d0, 6.2217869037019395643d0, &
          6.3761504949745149235d0, 6.5384904204498921866d0, 6.7096695630901298295d0, &
          6.8906917895506666737d0, 7.0827336620203012915d0, 7.2871854415570342284d0, &
          7.5057048110504567361d0, 7.7402883033437380539d0, 7.9933678354882366575d0, &
          8.2679435909824348458d0, 8.5677707729837147899d0, 8.8976283542313341457d0, &
          9.2637165068795250787d0, 9.6742632597148571675d0, 10.140485810085793567d0, &
          10.678183592439051565d0, 11.310526642688093896d0, 12.073281458938752409d0, &
          13.025508245773375324d0, 14.274217908050378899d0, 16.041733742399911629d0, &
          18.906551250528425796d0, 25.258065257528942350d0/)
  case default
     stop "GaussLaguerreQuadrature_roots_and_weights: with this n is not defined"
  end select
        
  

end subroutine GaussLaguerreQuadrature_roots_and_weights
